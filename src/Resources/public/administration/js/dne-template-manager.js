(function(){var e={526:function(){},242:function(){Shopware.Service("privileges").addPrivilegeMappingEntry({category:"permissions",parent:null,key:"dne_template_manager",roles:{viewer:{privileges:[],dependencies:[]},editor:{privileges:[],dependencies:["system.clear_cache"]},creator:{privileges:[],dependencies:["system.clear_cache"]},deleter:{privileges:[],dependencies:["system.clear_cache"]}}})},55:function(e,t,n){var a=n(526);a.__esModule&&(a=a.default),"string"==typeof a&&(a=[[e.id,a,""]]),a.locals&&(e.exports=a.locals),n(346).Z("8c89668c",a,!0,{})},346:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},i=0;i<t.length;i++){var s=t[i],l=s[0],r={id:e+":"+i,css:s[1],media:s[2],sourceMap:s[3]};a[l]?a[l].parts.push(r):n.push(a[l]={id:l,parts:[r]})}return n}n.d(t,{Z:function(){return h}});var i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var s={},l=i&&(document.head||document.getElementsByTagName("head")[0]),r=null,o=0,d=!1,m=function(){},c=null,p="data-vue-ssr-id",u="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function h(e,t,n,i){d=n,c=i||{};var l=a(e,t);return g(l),function(t){for(var n=[],i=0;i<l.length;i++){var r=s[l[i].id];r.refs--,n.push(r)}t?g(l=a(e,t)):l=[];for(var i=0;i<n.length;i++){var r=n[i];if(0===r.refs){for(var o=0;o<r.parts.length;o++)r.parts[o]();delete s[r.id]}}}}function g(e){for(var t=0;t<e.length;t++){var n=e[t],a=s[n.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](n.parts[i]);for(;i<n.parts.length;i++)a.parts.push(v(n.parts[i]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{for(var l=[],i=0;i<n.parts.length;i++)l.push(v(n.parts[i]));s[n.id]={id:n.id,refs:1,parts:l}}}}function f(){var e=document.createElement("style");return e.type="text/css",l.appendChild(e),e}function v(e){var t,n,a=document.querySelector("style["+p+'~="'+e.id+'"]');if(a){if(d)return m;a.parentNode.removeChild(a)}if(u){var i=o++;t=w.bind(null,a=r||(r=f()),i,!1),n=w.bind(null,a,i,!0)}else t=y.bind(null,a=f()),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){a?(a.css!==e.css||a.media!==e.media||a.sourceMap!==e.sourceMap)&&t(e=a):n()}}var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function w(e,t,n,a){var i=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var s=document.createTextNode(i),l=e.childNodes;l[t]&&e.removeChild(l[t]),l.length?e.insertBefore(s,l[t]):e.appendChild(s)}}function y(e,t){var n=t.css,a=t.media,i=t.sourceMap;if(a&&e.setAttribute("media",a),c.ssrId&&e.setAttribute(p,t.id),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}},t={};function n(a){var i=t[a];if(void 0!==i)return i.exports;var s=t[a]={id:a,exports:{}};return e[a](s,s.exports,n),s.exports}n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="bundles/dnetemplatemanager/",window?.__sw__?.assetPath&&(n.p=window.__sw__.assetPath+"/bundles/dnetemplatemanager/"),function(){"use strict";n(55);let{Component:e}=Shopware;e.register("dne-template-manager-tree",{template:'<sw-tabs class="dne-template-manager-tree">\n    <sw-tabs-item\n        :active="!isDocuments"\n        :disabled="tabsDisabled || isLoading"\n        @click="isDocuments = false"\n    >\n        {{ $t(\'dne-template-manager.storefrontTab\') }}\n    </sw-tabs-item>\n    <sw-tabs-item\n        :active="isDocuments"\n        :disabled="tabsDisabled || isLoading"\n        @click="isDocuments = true"\n    >\n        {{ $t(\'dne-template-manager.documentsTab\') }}\n    </sw-tabs-item>\n\n    <template slot="content">\n        <sw-data-grid\n                :dataSource="getItems"\n                :columns="columns"\n                :fullPage="false"\n                :showSettings="false"\n                :showSelection="false"\n                :showActions="false"\n                :isLoading="isLoading"\n                :allowColumnEdit="false"\n                :allowInlineEdit="false">\n            <template #column-name="{ item }">\n                <a\n                    href="#"\n                    :class="{\n                        \'sw-button-active\': selection === item.id,\n                        \'is-custom\': item.custom === 1\n                    }"\n                    @click.prevent="changeItem(item)"\n                >\n                    <sw-icon\n                        v-if="item.custom === 1"\n                        name="regular-file"\n                        :color="selection === item.id ? \'#ffffff\' : \'#007bff\'"\n                        size="14">\n                    </sw-icon>\n                    <sw-icon\n                        v-else\n                        name="regular-chevron-right"\n                        size="14">\n                    </sw-icon>\n                    {{ item.name }}\n                </a>\n            </template>\n            <template #column-label-name>\n                <span>\n                    {{ $t(\'dne-template-manager.nameLabel\') }}\n                </span>\n                <sw-text-field\n                    v-model:value="searchText"\n                    :placeholder="$t(\'dne-template-manager.searchLabel\')"\n                ></sw-text-field>\n                <sw-switch-field\n                    v-model:value="editedOnly"\n                    :label="$t(\'dne-template-manager.editedOnlyLabel\')"\n                ></sw-switch-field>\n            </template>\n        </sw-data-grid>\n    </template>\n</sw-tabs>\n',data(){return{items:{},isLoading:!0,tabsDisabled:!1,searchText:"",editedOnly:!1,isDocuments:!1,selection:null}},created(){this.loadItems()},computed:{getItems(){if(this.searchText.length||this.editedOnly){let e=Object.values(this.items);return this.searchText.length&&(e=e.filter(e=>-1!==e.name.indexOf(this.searchText))),this.editedOnly&&(e=e.filter(e=>1===e.custom)),e}return Object.values(this.items)},columns(){return[{property:"name",dataIndex:"name",label:this.$t("dne-template-manager.nameLabel"),allowResize:!1,sortable:!1,primary:!0}]}},watch:{isDocuments(e){this.isLoading=!0,this.loadItems(),this.selection=null,this.$emit("dne-template-manager-documents",e)}},methods:{onReload(e){this.isLoading=!0,this.loadItems(),e&&(this.selection=null)},onLoading(e){this.tabsDisabled=e},loadItems(){let e=Shopware.Service("syncService").httpClient,t={Authorization:`Bearer ${Shopware.Context.api.authToken.access}`,"Content-Type":"application/json"},n={};this.isDocuments&&(n.documents=!0),e.get("_action/dne-templatemanager/list",{headers:t,params:n}).then(({data:e})=>{this.items=e,this.isLoading=!1})},changeItem(e){this.selection=e.id,this.$emit("dne-template-manager-id-change",e.id)}}});let{Component:t}=Shopware;t.register("dne-template-manager-list",{template:'{% block dne_template_manager_list %}\n    <sw-page class="dne-template-manager-list">\n        <template #side-content>\n            <dne-template-manager-tree\n                ref="tree"\n                @dne-template-manager-id-change="onIdChange"\n                @dne-template-manager-documents="(value) => isDocuments = value"\n            ></dne-template-manager-tree>\n        </template>\n\n        <template #content>\n            {% block dne_template_manager_list_content %}\n                <dne-template-manager-detail\n                    ref="detail"\n                    @dne-template-manager-reload="onReload"\n                    @dne-template-manager-loading="onLoading"\n                    :is-documents="isDocuments"\n                ></dne-template-manager-detail>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n',data(){return{isDocuments:!1}},methods:{onIdChange(e){this.$refs.detail.setItem(e)},onReload(e){this.$refs.tree.onReload(e)},onLoading(e){this.$refs.tree.onLoading(e)}},metaInfo(){return{title:this.$createTitle()}}});let{Component:a,Mixin:i}=Shopware;a.register("dne-template-manager-detail",{template:'{% block dne_template_manager_detail %}\n    <sw-card-view>\n        <sw-card v-if="item" :isLoading="isLoading">\n            <sw-code-editor\n                    :label="`${$t(\'dne-template-manager.contentLabel\')} ${item.path}`"\n                    name="content"\n                    identifier="content"\n                    completionMode="entity"\n                    v-model:value="item.content">\n            </sw-code-editor>\n\n            <sw-button\n                    :isLoading="isLoading"\n                    :disabled="item.custom === 1 ? !acl.can(\'dne_template_manager.editor\') : !acl.can(\'dne_template_manager.creator\')"\n                    variant="primary"\n                    @click="onClickSave">\n                {{ $t(\'dne-template-manager.saveButton\') }}\n            </sw-button>\n\n            <sw-button\n                v-if="item.custom === 1"\n                :isLoading="isLoading"\n                :disabled="!acl.can(\'dne_template_manager.deleter\')"\n                variant="secondary"\n                @click="deleteModal = true">\n                {{ $t(\'dne-template-manager.deleteButton\') }}\n            </sw-button>\n\n            <sw-modal v-if="deleteModal"\n                      @modal-close="deleteModal = false"\n                      :title="$tc(\'global.default.warning\')"\n                      variant="small">\n                <p>\n                    {{ $tc(\'dne-template-manager.deleteWarning\') }}\n                </p>\n\n                <template #modal-footer>\n                    <sw-button @click="deleteModal = false" size="small">\n                        {{ $tc(\'dne-template-manager.cancelButton\') }}\n                    </sw-button>\n\n                    <sw-button @click="onClickDelete" variant="danger" size="small">\n                        {{ $tc(\'dne-template-manager.deleteButton\') }}\n                    </sw-button>\n                </template>\n            </sw-modal>\n        </sw-card>\n        <sw-card v-if="item" :isLoading="isLoading">\n            <sw-code-editor\n                :label="$t(\'dne-template-manager.originalContentLabel\')"\n                :disabled="true"\n                :editorConfig="{\n                    readOnly: true\n                }"\n                v-model:value="item.originalContent">\n            </sw-code-editor>\n        </sw-card>\n    </sw-card-view>\n{% endblock %}\n',inject:["acl","cacheApiService"],mixins:[i.getByName("notification")],metaInfo(){return{title:this.$createTitle()}},props:{isDocuments:Boolean},data(){return{httpClient:null,basicHeader:null,item:null,isLoading:!1,deleteModal:!1}},created(){this.httpClient=Shopware.Service("syncService").httpClient,this.basicHeaders={Authorization:`Bearer ${Shopware.Context.api.authToken.access}`,"Content-Type":"application/json"}},watch:{isDocuments(){this.item=null},isLoading(e){this.$emit("dne-template-manager-loading",e)}},methods:{setItem(e){if(!e)return;let t={};this.isDocuments&&(t.documents=!0),this.isLoading=!0,this.httpClient.post("_action/dne-templatemanager/detail",{path:e},{headers:this.basicHeaders,params:t}).then(({data:e})=>{this.item=e,this.isLoading=!1})},onClickSave(){this.doRequest("save")},onClickDelete(){this.deleteModal=!1,this.$nextTick().then(()=>{this.doRequest("delete")})},doRequest(e){this.isLoading=!0;let t={path:this.item.path,content:this.item.content};this.isDocuments&&(t.documents=!0),this.httpClient.post(`_action/dne-templatemanager/${e}`,t,{headers:this.basicHeaders}).then(()=>{this.cacheApiService.clear().then(()=>{this.isLoading=!1,this.$emit("dne-template-manager-reload","delete"===e),"delete"===e?this.item=null:this.item.custom=1})}).catch(e=>{this.isLoading=!1,this.createNotificationError({title:"Error",message:e})})}}}),n(242);var s=JSON.parse('{"dne-template-manager":{"title":"Custom Template Manager","menuEntry":"Custom Template","storefrontTab":"Verkaufskanal","documentsTab":"Dokumente","nameLabel":"Pfad","searchLabel":"Suchen","editedOnlyLabel":"nur bearbeitete","contentLabel":"Custom Template Inhalt von","originalContentLabel":"Original Template Inhalt","saveButton":"Speichern","deleteButton":"L\xf6schen","cancelButton":"Abbreichen","deleteWarning":"Sind Sie sicher, dass Sie das Custom Template endg\xfcltig l\xf6schen m\xf6chten?"},"sw-privileges":{"permissions":{"dne_template_manager":{"label":"Custom Template"}}}}'),l=JSON.parse('{"dne-template-manager":{"title":"Custom Template Manager","menuEntry":"Custom Template","storefrontTab":"Storefront","documentsTab":"Documents","nameLabel":"Path","searchLabel":"Search","editedOnlyLabel":"edited only","contentLabel":"Custom template content for","originalContentLabel":"Original template content","saveButton":"Save","deleteButton":"Delete","cancelButton":"Cancel","deleteWarning":"Are you sure you want to delete the custom template?"},"sw-privileges":{"permissions":{"dne_template_manager":{"label":"Custom Template"}}}}');let{Module:r}=Shopware;r.register("dne-template-manager",{color:"#ff3d58",icon:"regular-code",title:"dne-template-manager.title",description:"",snippets:{"de-DE":s,"en-GB":l},routes:{list:{component:"dne-template-manager-list",path:"list",meta:{privilege:"dne_template_manager.viewer"}}},navigation:[{label:"dne-template-manager.menuEntry",path:"dne.template.manager.list",parent:"sw-extension",position:100}]})}()})();
//# sourceMappingURL=dne-template-manager.js.map