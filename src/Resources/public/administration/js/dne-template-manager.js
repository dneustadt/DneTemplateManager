!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/bundles/dnetemplatemanager/",n(n.s="74ET")}({"6zrW":function(e,t,n){},"74ET":function(e,t,n){"use strict";n.r(t);var a=n("YPuP"),i=n.n(a);n("XWAH");Shopware.Component.register("dne-template-manager-tree",{template:i.a,data:function(){return{items:{},isLoading:!0,tabsDisabled:!1,searchText:"",editedOnly:!1,isDocuments:!1,selection:null}},created:function(){var e=this;this.loadItems(),this.$parent.$on("dne-template-manager-reload",(function(t){e.isLoading=!0,e.loadItems(),t&&(e.selection=null)})),this.$parent.$on("dne-template-manager-loading",(function(t){e.tabsDisabled=t}))},computed:{getItems:function(){var e=this;if(this.searchText.length||this.editedOnly){var t=Object.values(this.items);return this.searchText.length&&(t=t.filter((function(t){return-1!==t.name.indexOf(e.searchText)}))),this.editedOnly&&(t=t.filter((function(e){return 1===e.custom}))),t}return Object.values(this.items)},columns:function(){return[{property:"name",dataIndex:"name",label:this.$t("dne-template-manager.nameLabel"),allowResize:!1,sortable:!1,primary:!0}]}},watch:{isDocuments:function(e){this.isLoading=!0,this.loadItems(),this.selection=null,this.$emit("dns-template-manager-documents",e)}},methods:{loadItems:function(){var e=this,t=Shopware.Service("syncService").httpClient,n={Authorization:"Bearer ".concat(Shopware.Context.api.authToken.access),"Content-Type":"application/json"},a={};this.isDocuments&&(a.documents=!0),t.get("_action/dne-templatemanager/list",{headers:n,params:a}).then((function(t){var n=t.data;e.items=n,e.isLoading=!1}))},changeItem:function(e){this.selection=e.id,this.$parent.$emit("dne-template-manager-id-change",e.id)}}});var s=n("m6Pq"),r=n.n(s);Shopware.Component.register("dne-template-manager-list",{template:r.a,data:function(){return{isDocuments:!1}},metaInfo:function(){return{title:this.$createTitle()}}});var o=n("9yeF"),l=n.n(o),d=Shopware,c=d.Component,m=d.Mixin;c.register("dne-template-manager-detail",{template:l.a,inject:["acl"],mixins:[m.getByName("notification")],metaInfo:function(){return{title:this.$createTitle()}},props:{isDocuments:Boolean},data:function(){return{httpClient:null,basicHeader:null,item:null,isLoading:!1,deleteModal:!1}},created:function(){this.$parent.$on("dne-template-manager-id-change",this.setItem),this.httpClient=Shopware.Service("syncService").httpClient,this.basicHeaders={Authorization:"Bearer ".concat(Shopware.Context.api.authToken.access),"Content-Type":"application/json"}},watch:{isDocuments:function(){this.item=null},isLoading:function(e){this.$parent.$emit("dne-template-manager-loading",e)}},methods:{setItem:function(e){var t=this;if(e){var n={};this.isDocuments&&(n.documents=!0),this.isLoading=!0,this.httpClient.post("_action/dne-templatemanager/detail",{path:e},{headers:this.basicHeaders,params:n}).then((function(e){var n=e.data;t.item=n,t.isLoading=!1}))}},onClickSave:function(){this.doRequest("save")},onClickDelete:function(){var e=this;this.deleteModal=!1,this.$nextTick().then((function(){e.doRequest("delete")}))},doRequest:function(e){var t=this;this.isLoading=!0;var n={path:this.item.path,content:this.item.content};this.isDocuments&&(n.documents=!0),this.httpClient.post("_action/dne-templatemanager/".concat(e),n,{headers:this.basicHeaders}).then((function(n){var a=n.data.cacheWarmup?"cache_warmup":"cache";t.httpClient.delete("/_action/".concat(a),{headers:t.basicHeaders}).then((function(){t.isLoading=!1,t.$parent.$emit("dne-template-manager-reload","delete"===e),"delete"===e?t.item=null:t.item.custom=1}))})).catch((function(e){t.isLoading=!1,t.createNotificationError({title:"Error",message:e})}))}}});n("AYP9");var u=n("FiFG"),p=n("zskj");Shopware.Module.register("dne-template-manager",{color:"#ff3d58",icon:"default-shopping-paper-bag-product",title:"dne-template-manager.title",description:"",snippets:{"de-DE":u,"en-GB":p},routes:{list:{component:"dne-template-manager-list",path:"list",meta:{privilege:"dne_template_manager.viewer"}}},navigation:[{label:"dne-template-manager.menuEntry",path:"dne.template.manager.list",parent:"sw-extension",position:100}]})},"9yeF":function(e,t){e.exports='{% block dne_template_manager_detail %}\n    <sw-card-view>\n        <sw-card v-if="item" :isLoading="isLoading">\n            <sw-code-editor\n                    :label="`${$t(\'dne-template-manager.contentLabel\')} ${item.path}`"\n                    name="content"\n                    identifier="content"\n                    completionMode="entity"\n                    v-model="item.content">\n            </sw-code-editor>\n\n            <sw-button\n                    :isLoading="isLoading"\n                    :disabled="item.custom === 1 ? !acl.can(\'dne_template_manager.editor\') : !acl.can(\'dne_template_manager.creator\')"\n                    variant="primary"\n                    @click="onClickSave">\n                {{ $t(\'dne-template-manager.saveButton\') }}\n            </sw-button>\n\n            <sw-button\n                v-if="item.custom === 1"\n                :isLoading="isLoading"\n                :disabled="!acl.can(\'dne_template_manager.deleter\')"\n                variant="secondary"\n                @click="deleteModal = true">\n                {{ $t(\'dne-template-manager.deleteButton\') }}\n            </sw-button>\n\n            <sw-modal v-if="deleteModal"\n                      @modal-close="deleteModal = false"\n                      :title="$tc(\'global.default.warning\')"\n                      variant="small">\n                <p>\n                    {{ $tc(\'dne-template-manager.deleteWarning\') }}\n                </p>\n\n                <template #modal-footer>\n                    <sw-button @click="deleteModal = false" size="small">\n                        {{ $tc(\'dne-template-manager.cancelButton\') }}\n                    </sw-button>\n\n                    <sw-button @click="onClickDelete" variant="danger" size="small">\n                        {{ $tc(\'dne-template-manager.deleteButton\') }}\n                    </sw-button>\n                </template>\n            </sw-modal>\n        </sw-card>\n        <sw-card v-if="item" :isLoading="isLoading">\n            <sw-code-editor\n                :label="$t(\'dne-template-manager.originalContentLabel\')"\n                :disabled="true"\n                :editorConfig="{\n                    readOnly: true\n                }"\n                v-model="item.originalContent">\n            </sw-code-editor>\n        </sw-card>\n        <sw-card>\n            <p>{{ $t(\'dne-template-manager.migrationNotice\') }}</p>\n        </sw-card>\n    </sw-card-view>\n{% endblock %}\n'},AYP9:function(e,t){Shopware.Service("privileges").addPrivilegeMappingEntry({category:"permissions",parent:null,key:"dne_template_manager",roles:{viewer:{privileges:[],dependencies:[]},editor:{privileges:[],dependencies:["system.clear_cache"]},creator:{privileges:[],dependencies:["system.clear_cache"]},deleter:{privileges:[],dependencies:["system.clear_cache"]}}})},FiFG:function(e){e.exports=JSON.parse('{"dne-template-manager":{"title":"Custom Template Manager","menuEntry":"Custom Template","storefrontTab":"Verkaufskanal","documentsTab":"Dokumente","nameLabel":"Pfad","searchLabel":"Suchen","editedOnlyLabel":"nur bearbeitete","contentLabel":"Custom Template Inhalt von","originalContentLabel":"Original Template Inhalt","saveButton":"Speichern","deleteButton":"Löschen","cancelButton":"Abbreichen","deleteWarning":"Sind Sie sicher, dass Sie das Custom Template endgültig löschen möchten?","migrationNotice":"HINWEIS: Zukünftige Versionen dieses Plugins werden über das Friends Of Shopware Entwicklerkollektiv im Shopware Store bereitgestellt."},"sw-privileges":{"permissions":{"dne_template_manager":{"label":"Custom Template"}}}}')},SZ7m:function(e,t,n){"use strict";function a(e,t){for(var n=[],a={},i=0;i<t.length;i++){var s=t[i],r=s[0],o={id:e+":"+i,css:s[1],media:s[2],sourceMap:s[3]};a[r]?a[r].parts.push(o):n.push(a[r]={id:r,parts:[o]})}return n}n.r(t),n.d(t,"default",(function(){return f}));var i="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!i)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var s={},r=i&&(document.head||document.getElementsByTagName("head")[0]),o=null,l=0,d=!1,c=function(){},m=null,u="data-vue-ssr-id",p="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function f(e,t,n,i){d=n,m=i||{};var r=a(e,t);return h(r),function(t){for(var n=[],i=0;i<r.length;i++){var o=r[i];(l=s[o.id]).refs--,n.push(l)}t?h(r=a(e,t)):r=[];for(i=0;i<n.length;i++){var l;if(0===(l=n[i]).refs){for(var d=0;d<l.parts.length;d++)l.parts[d]();delete s[l.id]}}}}function h(e){for(var t=0;t<e.length;t++){var n=e[t],a=s[n.id];if(a){a.refs++;for(var i=0;i<a.parts.length;i++)a.parts[i](n.parts[i]);for(;i<n.parts.length;i++)a.parts.push(b(n.parts[i]));a.parts.length>n.parts.length&&(a.parts.length=n.parts.length)}else{var r=[];for(i=0;i<n.parts.length;i++)r.push(b(n.parts[i]));s[n.id]={id:n.id,refs:1,parts:r}}}}function g(){var e=document.createElement("style");return e.type="text/css",r.appendChild(e),e}function b(e){var t,n,a=document.querySelector("style["+u+'~="'+e.id+'"]');if(a){if(d)return c;a.parentNode.removeChild(a)}if(p){var i=l++;a=o||(o=g()),t=y.bind(null,a,i,!1),n=y.bind(null,a,i,!0)}else a=g(),t=S.bind(null,a),n=function(){a.parentNode.removeChild(a)};return t(e),function(a){if(a){if(a.css===e.css&&a.media===e.media&&a.sourceMap===e.sourceMap)return;t(e=a)}else n()}}var v,w=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function y(e,t,n,a){var i=n?"":a.css;if(e.styleSheet)e.styleSheet.cssText=w(t,i);else{var s=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function S(e,t){var n=t.css,a=t.media,i=t.sourceMap;if(a&&e.setAttribute("media",a),m.ssrId&&e.setAttribute(u,t.id),i&&(n+="\n/*# sourceURL="+i.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},XWAH:function(e,t,n){var a=n("6zrW");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);(0,n("SZ7m").default)("f877d6bc",a,!0,{})},YPuP:function(e,t){e.exports='<sw-tabs>\n    <sw-tabs-item\n        :active="!isDocuments"\n        :disabled="tabsDisabled || isLoading"\n        @click="isDocuments = false"\n    >\n        {{ $t(\'dne-template-manager.storefrontTab\') }}\n    </sw-tabs-item>\n    <sw-tabs-item\n        :active="isDocuments"\n        :disabled="tabsDisabled || isLoading"\n        @click="isDocuments = true"\n    >\n        {{ $t(\'dne-template-manager.documentsTab\') }}\n    </sw-tabs-item>\n\n    <template slot="content">\n        <sw-data-grid\n                :dataSource="getItems"\n                :columns="columns"\n                :fullPage="false"\n                :showSettings="false"\n                :showSelection="false"\n                :showActions="false"\n                :isLoading="isLoading"\n                :allowColumnEdit="false"\n                :allowInlineEdit="false"\n                class="dne-template-manager">\n            <template #column-name="{ item }">\n                <a\n                    href="#"\n                    :class="{\n                        \'sw-button-active\': selection === item.id,\n                        \'is-custom\': item.custom === 1\n                    }"\n                    @click.prevent="changeItem(item)"\n                >\n                    <sw-icon\n                        v-if="item.custom === 1"\n                        name="default-documentation-file"\n                        :color="selection === item.id ? \'#ffffff\' : \'#007bff\'"\n                        size="14">\n                    </sw-icon>\n                    <sw-icon\n                        v-else\n                        name="default-web-loading-star"\n                        size="14">\n                    </sw-icon>\n                    {{ item.name }}\n                </a>\n            </template>\n            <template #column-label-name>\n                <span>\n                    {{ $t(\'dne-template-manager.nameLabel\') }}\n                </span>\n                <sw-field\n                    v-model="searchText"\n                    type="text"\n                    :placeholder="$t(\'dne-template-manager.searchLabel\')"\n                ></sw-field>\n                <sw-switch-field\n                    v-model="editedOnly"\n                    :label="$t(\'dne-template-manager.editedOnlyLabel\')"\n                ></sw-switch-field>\n            </template>\n        </sw-data-grid>\n    </template>\n</sw-tabs>\n'},m6Pq:function(e,t){e.exports='{% block dne_template_manager_list %}\n    <sw-page class="dne-template-manager-list">\n        <template #side-content>\n            <dne-template-manager-tree\n                @dns-template-manager-documents="(value) => isDocuments = value"\n            ></dne-template-manager-tree>\n        </template>\n\n        <template slot="content">\n            {% block dne_template_manager_list_content %}\n                <dne-template-manager-detail\n                    :is-documents="isDocuments"\n                ></dne-template-manager-detail>\n            {% endblock %}\n        </template>\n    </sw-page>\n{% endblock %}\n'},zskj:function(e){e.exports=JSON.parse('{"dne-template-manager":{"title":"Custom Template Manager","menuEntry":"Custom Template","storefrontTab":"Storefront","documentsTab":"Documents","nameLabel":"Path","searchLabel":"Search","editedOnlyLabel":"edited only","contentLabel":"Custom template content for","originalContentLabel":"Original template content","saveButton":"Save","deleteButton":"Delete","cancelButton":"Cancel","deleteWarning":"Are you sure you want to delete the custom template?","migrationNotice":"NOTICE: Future versions of this plugins will be provided by the developer collective Friends Of Shopware within the Shopware Store"},"sw-privileges":{"permissions":{"dne_template_manager":{"label":"Custom Template"}}}}')}});
//# sourceMappingURL=dne-template-manager.js.map